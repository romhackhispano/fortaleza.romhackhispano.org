<html>
<head>
<title>Source: source.html</title>
</head>
<!-- Generated by SynEdit HTML exporter -->
<body text="#000000" bgcolor="#FFFFFF">
<pre>
<code><font  size=3 face="Courier New"><font color="#000000"><i>'###############################################################################
'# Parte de código de ejemplo para un insertor de scripts en Visual Basic 6.0  #
'# Hexplus - Fortaleza Romhack 2007                                            #
'# Este código aplica para un solo diálogo                                     #
'# Este código fuente no pretende ser el mejor código para realizar esto       #
'# Si utilizas este código en tus programas o parte de &eacute;l, por favor, hazlo    #
'# saber por favor en &eacute;l. Nada cuesta dar gracias.                             #
'# Consultas a: hexplus@gmail.com                                              #
'###############################################################################

'---------------------------------------------------------------------------------------------------------------

'Esta es la estructura de la tabla, esto deberia ir en un módulo
</i><font color="#008000">Type tabla
    hexa </font><font color="#0000FF">As String
    </font><font color="#008000">valor </font><font color="#0000FF">As String
End </font><font color="#008000">Type

</font><i>'Al igual,  la declaración de la tabla, deberia estar en el mismo módulo
</i><font color="#0000FF">Public </font><font color="#008000">tablaT</font>(</span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">To </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">5000</font></span><span style="background-color: #FFFFFF">) <font color="#0000FF">As </font><font color="#008000">tabla

</font><i>'---------------------------------------------------------------------------------------------------------------

'Este es el procedimiento para convertir e insertar ese texto convertido en bytes en la ROM
'Podría estar mejor optimizado creo yo, no pretende ser el estándar, ni el mejor código existente
</i><font color="#0000FF">Private Sub </font><font color="#008000">cmdInsertar_click</font>()
    <i>'Definición de variables
    </i><font color="#0000FF">Dim </font><font color="#008000">texto </font><font color="#0000FF">As String </font><i>'Esta variable recogerá el texto que traducimos y queremos insertar
    </i><font color="#008000">texto </font>= <font color="#FF00FF">&quot;&quot; </font><i>'la inicializo
    </i><font color="#0000FF">Dim </font><font color="#008000">cadenaInsertar </font><font color="#0000FF">As String </font><i>'Recogerá el texto traducido ya convertido en bytes
    </i><font color="#008000">cadenaInsertar </font>= <font color="#FF00FF">&quot;&quot;  </font><i>'inicializo
    </i><font color="#0000FF">Dim </font><font color="#008000">maximo </font><font color="#0000FF">As Integer  </font><i>'maximo es una variable que me indica cual es la palabra mas larga en la
                              'tabla MTE, si es DTE obvio que siempre es 2
    </i><font color="#008000">maximo </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">0</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><i>'Inicializo

    </i><font color="#0000FF">Dim </font><font color="#008000">i </font><font color="#0000FF">As Integer </font><i>'Contador para For
    </i><font color="#0000FF">Dim </font><font color="#008000">j </font><font color="#0000FF">As Integer </font><i>'Contador para For
    </i><font color="#0000FF">Dim </font><font color="#008000">k </font><font color="#0000FF">As Integer </font><i>'Contador para For
    </i><font color="#0000FF">Dim </font><font color="#008000">tmp </font><font color="#0000FF">As String </font><i>'Variable temporal para recoger texto
    </i><font color="#008000">tmp </font>= <font color="#FF00FF">&quot;&quot;

    </font><font color="#0000FF">Dim </font><font color="#008000">tag </font><font color="#0000FF">As String </font><i>'Etiqueta


    </i><font color="#0000FF">If Len</font>(<font color="#008000">rtxtTraducido</font>.<font color="#008000">Text</font>) = </span><span style="background-color: #FFFFFF"><font color="#FF0000">0</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">Then
        MsgBox </font><font color="#FF00FF">&quot;¡Nada que insertar!&quot;
        </font><font color="#0000FF">Exit Sub
    End If

    Dim </font><font color="#008000">offset </font><font color="#0000FF">As Long </font><i>'Direccion a insertar
    </i><font color="#0000FF">Dim </font><font color="#008000">nroArchivo </font><font color="#0000FF">As Integer </font><i>'Numero de archivo en donde vamos a insertar


    'Pedimos confirmación
    </i><font color="#008000">mensaje </font>= <font color="#0000FF">MsgBox</font>(<font color="#FF00FF">&quot;¿Está seguro de insertar el Script?&quot;</font>, <font color="#008000">vbQuestion </font>+ <font color="#008000">vbYesNo</font>, <font color="#FF00FF">&quot;Confirmación requerida&quot;</font>)
    <font color="#0000FF">If </font><font color="#008000">mensaje </font>&lt;&gt; <font color="#008000">vbYes </font><font color="#0000FF">Then Exit Sub

    </font><i>'Transformación a formato de inserción:
    
    </i><font color="#008000">texto </font>= <font color="#008000">rtxtTraducido</font>.<font color="#008000">Text </font><i>'Es el texto de la caja de texto traducido, se la asignamos a la variable texto
    </i><font color="#008000">maximo </font>= <font color="#008000">masLargoO </font><i>'Es el valor del largo de la palabra mas larga de la tabla
        
    </i><font color="#0000FF">For </font><font color="#008000">i </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">To Len</font>(<font color="#008000">texto</font>) <i>'De 1 al largo total del texto, recorro todo el texto
        </i><font color="#0000FF">For </font><font color="#008000">j </font>= <font color="#008000">maximo </font><font color="#0000FF">To </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#008000">Step </font>-</span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><i>'Del largo de la palabra mas larga a 1

            </i><font color="#008000">tmp </font>= <font color="#0000FF">Mid</font>(<font color="#008000">texto</font>, <font color="#008000">i</font>, <font color="#008000">j</font>) <i>'Leo una porción de cadena del texto

            'Primero trato los saltos de linea
            </i><font color="#0000FF">If </font><font color="#008000">tmp </font>= <font color="#008000">vbCr </font><font color="#0000FF">Then </font><i>'Si esa porción es un vbCr, entonces es un salto de línea
                 </i><font color="#0000FF">For </font><font color="#008000">k </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">To </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">5000</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><i>'En busca del * del salto de línea en la tabla
                     </i><font color="#0000FF">If </font><font color="#008000">tablaT</font>(<font color="#008000">k</font>).<font color="#008000">valor </font>= <font color="#FF00FF">&quot;LINE&quot; </font><font color="#0000FF">Then </font><i>'En este caso busco 'LINE' en la tabla ¨&quot;traducida&quot;
                                                          'valor que asigne para en salto de linea
                                                      'Si buscara un * me devolvería el valor del asterisco
                         </i><font color="#008000">cadenaInsertar </font>= <font color="#008000">cadenaInsertar </font>&amp; <font color="#008000">HexToStr</font>(<font color="#008000">tablaT</font>(<font color="#008000">k</font>).<font color="#008000">hexa</font>) <i>'Acumulo el byte en la cadena a insertar
                         </i><font color="#0000FF">Exit For </font><i>'Aborto el For
                     </i><font color="#0000FF">End If
                 Next
                 </font><font color="#008000">i </font>= <font color="#008000">i </font>+ </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><i>'Sumo 1 a la posicion en el texto
                 </i><font color="#0000FF">GoTo </font><font color="#008000">siguiente  ´Voy a siguiente</font>, <font color="#008000">para leer otra cadena </font>/ <font color="#008000">A veces </font><font color="#0000FF">GoTo </font><font color="#008000">es una maldicion</font>, <font color="#008000">a veces ideal </font>^^
             <font color="#0000FF">End If

             </font><i>'Luego trato los fines de bloque
             </i><font color="#0000FF">If </font><font color="#008000">tmp </font>= <font color="#008000">lEnclosure </font><font color="#0000FF">Then </font><i>'Cierre izquierdo(lEnclosure), ya sea { o &lt;
                 </i><font color="#008000">tag </font>= <font color="#FF00FF">&quot;&quot;
                 </font><font color="#0000FF">While </font><font color="#008000">tmp </font>&lt;&gt; <font color="#008000">rEnclosure </font><i>'Mientras tmp sea diferente a cierre derecho (rEnclosure)
                     </i><font color="#008000">i </font>= <font color="#008000">i </font>+ </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><i>'Sumo 1 a la posición que tenemos en el texto
                     </i><font color="#008000">tmp </font>= <font color="#0000FF">Mid</font>(<font color="#008000">texto</font>, <font color="#008000">i</font>, <font color="#008000">j</font>) <i>'Leo del texto
                     </i><font color="#008000">tag </font>= <font color="#008000">tag </font>&amp; <font color="#008000">tmp </font><i>'Voy acumulando lo que hay despues del inicio de la llave
                     </i><font color="#0000FF">If Left</font>(<font color="#008000">tag</font>, <font color="#0000FF">Len</font>(<font color="#008000">tag</font>) - </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">) = <font color="#FF00FF">&quot;END&quot; </font><font color="#0000FF">Then </font><i>'Comparo si tag es igual a END
                         </i><font color="#0000FF">For </font><font color="#008000">k </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">To </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">5000</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><i>'En busca del / del fin de bloque
                             </i><font color="#0000FF">If </font><font color="#008000">tablaT</font>(<font color="#008000">k</font>).<font color="#008000">valor </font>= <font color="#FF00FF">&quot;END&quot; </font><font color="#0000FF">Then
                                 </font><font color="#008000">cadenaInsertar </font>= <font color="#008000">cadenaInsertar </font>&amp; <font color="#008000">HexToStr</font>(<font color="#008000">tablaT</font>(<font color="#008000">k</font>).<font color="#008000">hexa</font>) <i>'Acumulamos el byte
                             </i><font color="#0000FF">Exit For
                         End If
                     Next
                     </font><font color="#008000">i </font>= <font color="#008000">i </font>+ </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">                     </font><font color="#0000FF">GoTo </font><font color="#008000">siguiente </font><i>'Continuamos con la siguiente cadena o siguiente byte
                     </i><font color="#0000FF">End If
                 Wend
             End If
             
             </font><i>'Cualquier otro valor que no sea un salto de línea o un fin de bloque
             </i><font color="#0000FF">For </font><font color="#008000">k </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">To </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">5000
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">                 </font><font color="#0000FF">If </font><font color="#008000">tablaT</font>(<font color="#008000">k</font>).<font color="#008000">valor </font>= <font color="#008000">vbNullString </font><font color="#0000FF">Then Exit For
                 If </font><font color="#008000">tmp </font>= <font color="#FF00FF">&quot;END&quot; </font><font color="#0000FF">Then Exit For </font><i>'Esto es por si existiese una palabra por ejemplo 'TENDENCIA'
                 </i><font color="#0000FF">If </font><font color="#008000">tmp </font>= <font color="#FF00FF">&quot;LINE&quot; </font><font color="#0000FF">Then Exit For  </font><i>'Similar al anterior
                 </i><font color="#0000FF">If </font><font color="#008000">tmp </font>= <font color="#008000">tablaT</font>(<font color="#008000">k</font>).<font color="#008000">valor </font><font color="#0000FF">Then </font><i>'Aqui entra cualquier otro valor que no sean saltos ni fin de bloque
                     </i><font color="#008000">cadenaInsertar </font>= <font color="#008000">cadenaInsertar </font>&amp; <font color="#008000">HexToStr</font>(<font color="#008000">tablaT</font>(<font color="#008000">k</font>).<font color="#008000">hexa</font>) <i>'Acumulamos
                     </i><font color="#008000">i </font>= <font color="#008000">i </font>+ <font color="#0000FF">Len</font>(<font color="#008000">tmp</font>) - </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">                     </font><font color="#0000FF">GoTo </font><font color="#008000">siguiente
                  </font><font color="#0000FF">End If
             Next
         Next
         </font><i>'Se supone que para este punto que el largo de tmp tiene que quedar en cero
         </i><font color="#0000FF">If Len</font>(<font color="#008000">tmp</font>) = </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">Then </font><i>'Si el largo de tmp es 1, quiere decir que no se encontró ese caracter en la tabla traducida
             </i><font color="#008000">mensaje </font>= <font color="#0000FF">MsgBox</font>(<font color="#FF00FF">&quot;Caracter '&quot; </font>&amp; <font color="#008000">tmp </font>&amp; <font color="#FF00FF">&quot;'&quot; </font>&amp; <font color="#008000">vbCrLf </font>&amp; <font color="#FF00FF">&quot;[Ascii: &quot; </font>&amp; <font color="#0000FF">Asc</font>(<font color="#008000">tmp</font>) &amp; <font color="#FF00FF">&quot;] no existe en la tabla.&quot; </font>&amp; <font color="#008000">vbCrLf </font>&amp; <font color="#FF00FF">&quot;¿Desea insertar el script de todos modos?&quot;</font>, <font color="#008000">vbCritical </font>+ <font color="#008000">vbYesNo</font>, <font color="#FF00FF">&quot;Precaución&quot;</font>)
             <font color="#0000FF">If </font><font color="#008000">mensaje </font>= <font color="#008000">vbNo </font><font color="#0000FF">Then
                 </font><font color="#008000">rtxtTraducido</font>.<font color="#008000">SelStart </font>= <font color="#008000">i   </font><i>'Nos posicionamos en donde está el caracter no encontrado en el RichTexbox
                 </i><font color="#008000">rtxtTraducido</font>.<font color="#008000">SelLength </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">                 </font><font color="#008000">rtxtTraducido</font>.<font color="#008000">SetFocus
                 </font><font color="#0000FF">Exit Sub
             End If
         End If
</font><font color="#008000">siguiente</font>:
     <font color="#0000FF">Next
     
     </font><i>'Inserción:
     'Se llega a este punto cuando ya se ha recorrido toda la cadena de texto que queremos insertar
     </i><font color="#008000">offset </font>= <font color="#008000">HexToDec</font>(<font color="#0000FF">Left</font>(<font color="#008000">Scripts</font>.<font color="#008000">FileName</font>, <font color="#0000FF">Len</font>(<font color="#008000">Scripts</font>.<font color="#008000">FileName</font>) - </span><span style="background-color: #FFFFFF"><font color="#FF0000">4</font></span><span style="background-color: #FFFFFF">)) + </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><i>'Esto lo hago pues este codigo utiliza el nombre
     'de archivos del Hextractor (programa que hice para extraer scripts)
     </i><font color="#008000">nroArchivo </font>= <font color="#0000FF">FreeFile
     Open </font><font color="#008000">ROM </font><font color="#0000FF">For </font><font color="#008000">Binary </font><font color="#0000FF">As </font><font color="#FF00FF">#nroArchivo
     </font><font color="#0000FF">Put </font><font color="#FF00FF">#nroArchivo, offset, cadenaInsertar
     </font><font color="#0000FF">Close </font><font color="#FF00FF">#nroArchivo
     </font><font color="#0000FF">MsgBox </font><font color="#FF00FF">&quot;Se han insertado &quot; </font>&amp; <font color="#0000FF">Len</font>(<font color="#008000">cadenaInsertar</font>) &amp; <font color="#FF00FF">&quot; bytes en la dirección 0x&quot; </font>&amp; <font color="#0000FF">Left</font>(<font color="#008000">Scripts</font>.<font color="#008000">FileName</font>, <font color="#0000FF">Len</font>(<font color="#008000">Scripts</font>.<font color="#008000">FileName</font>) - </span><span style="background-color: #FFFFFF"><font color="#FF0000">4</font></span><span style="background-color: #FFFFFF">) &amp; <font color="#FF00FF">&quot;.&quot;

</font><font color="#0000FF">End Sub

</font><i>'---------------------------------------------------------------------------------------------------------------

'Procedimiento sencillísimo para cargar una tabla thingy con salto de linea y fin de bloque de texto
'Podría mejorarse, por supuesto
'En este caso recibimos el número de archivo como parámetro, pero puedes adecuarlo a tu gusto
</i><font color="#0000FF">Private Sub </font><font color="#008000">cargarTablaT</font>(<font color="#008000">nro </font><font color="#0000FF">As Integer</font>)
<i>'On Error Resume Next
</i><font color="#0000FF">Dim </font><font color="#008000">cadena </font><font color="#0000FF">As String
Dim </font><font color="#008000">i </font><font color="#0000FF">As Integer
</font><font color="#008000">i </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><i>'Tblt ya habia sido declarado globalmente y este es el nombre de la tabla
</i><font color="#0000FF">Open </font><font color="#008000">TbLt </font><font color="#0000FF">For Input As </font><font color="#FF00FF">#nro
</font><font color="#0000FF">While Not EOF</font>(<font color="#008000">nro</font>) <i>'Mientras no sea el fin de la tabla
    </i><font color="#0000FF">Line Input </font><font color="#FF00FF">#nro, cadena
    </font><font color="#0000FF">If InStr</font>(</span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">, <font color="#008000">cadena</font>, <font color="#FF00FF">&quot;=&quot;</font>) &gt; </span><span style="background-color: #FFFFFF"><font color="#FF0000">0</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">Then
        </font><font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">hexa </font>= <font color="#0000FF">Left</font>(<font color="#008000">cadena</font>, <font color="#0000FF">InStr</font>(<font color="#008000">cadena</font>, <font color="#FF00FF">&quot;=&quot;</font>) - </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)
        <font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">valor </font>= <font color="#0000FF">Right</font>(<font color="#008000">cadena</font>, <font color="#0000FF">Len</font>(<font color="#008000">cadena</font>) - <font color="#0000FF">InStr</font>(<font color="#008000">cadena</font>, <font color="#FF00FF">&quot;=&quot;</font>))
        <font color="#008000">i </font>= <font color="#008000">i </font>+ </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">    </font><font color="#0000FF">Else
        If Left</font>(<font color="#008000">cadena</font>, </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">) = <font color="#FF00FF">&quot;/&quot; </font><font color="#0000FF">Then  </font><i>'Fin de linea
            </i><font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">hexa </font>= <font color="#0000FF">Right</font>(<font color="#008000">cadena</font>, <font color="#0000FF">Len</font>(<font color="#008000">cadena</font>) - </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)
            <font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">valor </font>= <font color="#FF00FF">&quot;END&quot; </font><i>'Pongo valor en &quot;END&quot; para no interferir con el valor de /
            </i><font color="#008000">i </font>= <font color="#008000">i </font>+ </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">        </font><font color="#0000FF">Else
            If Left</font>(<font color="#008000">cadena</font>, </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">) = <font color="#FF00FF">&quot;*&quot; </font><font color="#0000FF">Then </font><i>'Salto de linea
                </i><font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">hexa </font>= <font color="#0000FF">Right</font>(<font color="#008000">cadena</font>, <font color="#0000FF">Len</font>(<font color="#008000">cadena</font>) - </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)
                <font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">valor </font>= <font color="#FF00FF">&quot;LINE&quot; </font><i>'Igual, para no interferir con el &quot;*&quot; (asterisco)
                </i><font color="#008000">i </font>= <font color="#008000">i </font>+ </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">            </font><font color="#0000FF">End If
        End If
    End If
Wend
End Sub

</font><i>'---------------------------------------------------------------------------------------------------------------
'Función que devuelve la palabra más larga en la tabla
</i><font color="#0000FF">Private Function </font><font color="#008000">masLargaT</font>() <font color="#0000FF">As Integer
</font><i>'Esta funcion mide cual palabra es la más larga que existe en la tabla
</i><font color="#0000FF">Dim </font><font color="#008000">masLargo </font><font color="#0000FF">As Integer
</font><font color="#008000">masLargo </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><font color="#0000FF">Dim </font><font color="#008000">largo </font><font color="#0000FF">As Integer
</font><font color="#008000">largo </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">0
</font></span><span style="background-color: #FFFFFF"><i>'Primero verifico los triples
</i><font color="#0000FF">Dim </font><font color="#008000">i </font><font color="#0000FF">As Integer
For </font><font color="#008000">i </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">To </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">5000
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">    </font><font color="#0000FF">If </font><font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">valor </font>= <font color="#008000">vbNullString </font><font color="#0000FF">Then Exit For
    If </font><font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">valor </font>= <font color="#FF00FF">&quot;END&quot; </font><font color="#0000FF">Or </font><font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">valor </font>= <font color="#FF00FF">&quot;LINE&quot; </font><font color="#0000FF">Then GoTo </font><font color="#008000">siguiente </font><i>'Para no tomar en cuenta estas dos palabras
    </i><font color="#008000">largo </font>= <font color="#0000FF">Len</font>(<font color="#008000">tablaT</font>(<font color="#008000">i</font>).<font color="#008000">valor</font>)
    <font color="#0000FF">If </font><font color="#008000">largo </font>&gt; <font color="#008000">masLargo </font><font color="#0000FF">Then
        </font><font color="#008000">masLargo </font>= <font color="#008000">largo
    </font><font color="#0000FF">End If
</font><font color="#008000">siguiente</font>:
<font color="#0000FF">Next
</font><font color="#008000">masLargaT </font>= <font color="#008000">masLargo
</font><font color="#0000FF">End Function

</font><i>'-------------------------------------------------------------------------------------------------------------------------

'Función para convertir de Hexadecimal a Decimal, utilizo &eacute;sta, pues la funcion Hex$(String) tiene límitantes cuando
'se trata de numeros muy grandes
</i><font color="#0000FF">Function </font><font color="#008000">HexToDec</font>(<font color="#008000">HexStr </font><font color="#0000FF">As String</font>) <font color="#0000FF">As Long </font><i>'Funcion para convertir de hexadecimal a decimal
</i><font color="#0000FF">Dim </font><font color="#008000">strlen </font><font color="#0000FF">As Integer
Dim </font><font color="#008000">Ctr </font><font color="#0000FF">As Integer
Dim </font><font color="#008000">Word </font><font color="#0000FF">As String </font>* </span><span style="background-color: #FFFFFF"><font color="#FF0000">1
</font></span><span style="background-color: #FFFFFF"><font color="#0000FF">Dim </font><font color="#008000">lngTemp </font><font color="#0000FF">As Long

    </font><font color="#008000">strlen </font>= <font color="#0000FF">Len</font>(<font color="#008000">HexStr</font>)

    <font color="#008000">HexStr </font>= <font color="#0000FF">UCase</font>(<font color="#008000">HexStr</font>)

    <font color="#0000FF">For </font><font color="#008000">Ctr </font>= <font color="#008000">strlen </font><font color="#0000FF">To </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#008000">Step </font>-</span><span style="background-color: #FFFFFF"><font color="#FF0000">1

</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">        </font><font color="#008000">Word </font>= <font color="#0000FF">Left</font><font color="#008000">$</font>(<font color="#008000">HexStr</font>, </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)

        <font color="#008000">HexStr </font>= <font color="#0000FF">Mid</font>(<font color="#008000">HexStr</font>, </span><span style="background-color: #FFFFFF"><font color="#FF0000">2</font></span><span style="background-color: #FFFFFF">, <font color="#0000FF">Len</font>(<font color="#008000">HexStr</font>) - </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)

        <font color="#0000FF">Select Case </font><font color="#008000">Word

            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;0&quot;
                </font><font color="#008000">lngTemp </font>= <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;1&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;2&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">2</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;3&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">3</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;4&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">4</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;5&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</fod-color: #FFFFFF"><font color="#FF0000">16</foFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">5</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;6&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">6</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;7&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">7</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;8&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">8</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;9&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">9</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;A&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">10</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;B&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">11</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;C&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">12</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;D&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">13</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;E&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">14</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp
            </font><font color="#0000FF">Case </font><font color="#FF00FF">&quot;F&quot;
                </font><font color="#008000">lngTemp </font>= (</span><span style="background-color: #FFFFFF"><font color="#FF0000">16</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>^ (<font color="#008000">Ctr </font>- </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)) * </span><span style="background-color: #FFFFFF"><font color="#FF0000">15</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font>+ <font color="#008000">lngTemp

            </font><font color="#0000FF">Case Else
        End Select

    Next
    </font><font color="#008000">HexToDec </font>= <font color="#008000">lngTemp

</font><font color="#0000FF">End Function

</font><i>'---------------------------------------------------------------------------------------------------------------

</i><font color="#008000">Convierte un número hexadecimal a una cadena de </font><font color="#FF00FF">&quot;texto&quot;

</font><font color="#0000FF">Function </font><font color="#008000">HexToStr</font>(<font color="#008000">HexStr </font><font color="#0000FF">As String</font>) <font color="#0000FF">As String
Dim </font><font color="#008000">nCtr </font><font color="#0000FF">As Long
Dim </font><font color="#008000">nCount </font><font color="#0000FF">As Long
Dim </font><font color="#008000">tmpBuffer </font><font color="#0000FF">As String
Dim </font><font color="#008000">tmpBuffer1 </font><font color="#0000FF">As String
Dim </font><font color="#008000">tmpChar </font><font color="#0000FF">As String

Trim </font>(<font color="#008000">HexStr</font>)
<font color="#0000FF">For </font><font color="#008000">nCtr </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">To Len</font>(<font color="#008000">HexStr</font>)
   <font color="#008000">tmpChar </font>= <font color="#0000FF">Mid</font>(<font color="#008000">HexStr</font>, <font color="#008000">nCtr</font>, </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF">)
   <font color="#0000FF">If Not </font><font color="#008000">tmpChar </font>= <font color="#FF00FF">&quot; &quot; </font><font color="#0000FF">Then
      </font><font color="#008000">tmpBuffer </font>= <font color="#008000">tmpBuffer </font>&amp; <font color="#008000">tmpChar
      tmpChar </font>= <font color="#FF00FF">&quot;&quot;
   </font><font color="#0000FF">End If
Next

</font><font color="#008000">nCount </font>= <font color="#0000FF">Len</font>(<font color="#008000">tmpBuffer</font>)
<font color="#0000FF">If Not </font>(<font color="#008000">nCount </font><font color="#0000FF">Mod </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">2</font></span><span style="background-color: #FFFFFF">) = </span><span style="background-color: #FFFFFF"><font color="#FF0000">0</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">Then Exit Function

For </font><font color="#008000">nCtr </font>= </span><span style="background-color: #FFFFFF"><font color="#FF0000">1</font></span><span style="background-color: #FFFFFF"><font color="#FF0000"> </font><font color="#0000FF">To </font><font color="#008000">nCount Step </font></span><span style="background-color: #FFFFFF"><font color="#FF0000">2
</font></span><span style="background-color: #FFFFFF"><font color="#FF0000">    </font><font color="#008000">tmpBuffer1 </font>= <font color="#008000">tmpBuffer1 </font>&amp; <font color="#0000FF">Chr</font>(<font color="#008000">HexToDec</font>(<font color="#0000FF">Mid</font>(<font color="#008000">tmpBuffer</font>, <font color="#008000">nCtr</font>, </span><span style="background-color: #FFFFFF"><font color="#FF0000">2</font></span><span style="background-color: #FFFFFF">)))
<font color="#0000FF">Next
    </font><font color="#008000">HexToStr </font>= <font color="#008000">tmpBuffer1
</font><font color="#0000FF">End Function

</font><i>'-----------------------------------------------------------------------------------------------------------------------------


</i></font>
</code></pre>
<a href="http://fortaleza.romhackhispano.org/documentos.html">Volver a 'Documentos'</a> - <a href="http://fortaleza.romhackhispano.org/index.html">Ir al inicio</a>
</body>
</html>